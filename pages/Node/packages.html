<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一、minimist （命令行参数解析） | youngqluol&#39;s blogs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/frontend-blogs/logo.jpg">
    <meta name="description" content="">
    
    <link rel="preload" href="/frontend-blogs/assets/css/0.styles.09184f4e.css" as="style"><link rel="preload" href="/frontend-blogs/assets/js/app.6cbc603a.js" as="script"><link rel="preload" href="/frontend-blogs/assets/js/2.9c8862ee.js" as="script"><link rel="preload" href="/frontend-blogs/assets/js/25.aad0ee25.js" as="script"><link rel="prefetch" href="/frontend-blogs/assets/js/10.ef7b6cc4.js"><link rel="prefetch" href="/frontend-blogs/assets/js/11.4a8ecf3e.js"><link rel="prefetch" href="/frontend-blogs/assets/js/12.a24ed91a.js"><link rel="prefetch" href="/frontend-blogs/assets/js/13.c9b28ca3.js"><link rel="prefetch" href="/frontend-blogs/assets/js/14.db4e34cd.js"><link rel="prefetch" href="/frontend-blogs/assets/js/15.70504961.js"><link rel="prefetch" href="/frontend-blogs/assets/js/16.cc0ad624.js"><link rel="prefetch" href="/frontend-blogs/assets/js/17.5a32792c.js"><link rel="prefetch" href="/frontend-blogs/assets/js/18.19744f08.js"><link rel="prefetch" href="/frontend-blogs/assets/js/19.3ac3f497.js"><link rel="prefetch" href="/frontend-blogs/assets/js/20.a7e5e8a3.js"><link rel="prefetch" href="/frontend-blogs/assets/js/21.37a95cd0.js"><link rel="prefetch" href="/frontend-blogs/assets/js/22.8584ab96.js"><link rel="prefetch" href="/frontend-blogs/assets/js/23.574575ad.js"><link rel="prefetch" href="/frontend-blogs/assets/js/24.b4a1cf90.js"><link rel="prefetch" href="/frontend-blogs/assets/js/26.95944c4a.js"><link rel="prefetch" href="/frontend-blogs/assets/js/27.db330891.js"><link rel="prefetch" href="/frontend-blogs/assets/js/28.125f617b.js"><link rel="prefetch" href="/frontend-blogs/assets/js/29.a7f7cad5.js"><link rel="prefetch" href="/frontend-blogs/assets/js/3.df072701.js"><link rel="prefetch" href="/frontend-blogs/assets/js/30.67a830ac.js"><link rel="prefetch" href="/frontend-blogs/assets/js/31.facfaada.js"><link rel="prefetch" href="/frontend-blogs/assets/js/32.b726c43e.js"><link rel="prefetch" href="/frontend-blogs/assets/js/33.0e2e0b35.js"><link rel="prefetch" href="/frontend-blogs/assets/js/34.f05dc975.js"><link rel="prefetch" href="/frontend-blogs/assets/js/35.4c4fd6a8.js"><link rel="prefetch" href="/frontend-blogs/assets/js/36.74075f71.js"><link rel="prefetch" href="/frontend-blogs/assets/js/37.4266fc7d.js"><link rel="prefetch" href="/frontend-blogs/assets/js/38.9711023b.js"><link rel="prefetch" href="/frontend-blogs/assets/js/39.560e74bd.js"><link rel="prefetch" href="/frontend-blogs/assets/js/4.9c0d3927.js"><link rel="prefetch" href="/frontend-blogs/assets/js/40.44bd9495.js"><link rel="prefetch" href="/frontend-blogs/assets/js/41.cf182c7c.js"><link rel="prefetch" href="/frontend-blogs/assets/js/42.ffbe87c9.js"><link rel="prefetch" href="/frontend-blogs/assets/js/43.6106fbf5.js"><link rel="prefetch" href="/frontend-blogs/assets/js/44.f831a2f0.js"><link rel="prefetch" href="/frontend-blogs/assets/js/45.f9b1716a.js"><link rel="prefetch" href="/frontend-blogs/assets/js/46.fff54584.js"><link rel="prefetch" href="/frontend-blogs/assets/js/47.77f130e2.js"><link rel="prefetch" href="/frontend-blogs/assets/js/48.4ab60e76.js"><link rel="prefetch" href="/frontend-blogs/assets/js/5.8fb2962b.js"><link rel="prefetch" href="/frontend-blogs/assets/js/6.7a505dc8.js"><link rel="prefetch" href="/frontend-blogs/assets/js/7.1ebac3c6.js"><link rel="prefetch" href="/frontend-blogs/assets/js/8.7a5d7e5c.js"><link rel="prefetch" href="/frontend-blogs/assets/js/9.ecd8904a.js">
    <link rel="stylesheet" href="/frontend-blogs/assets/css/0.styles.09184f4e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/frontend-blogs/" class="home-link router-link-active"><img src="/frontend-blogs/logo.jpg" alt="youngqluol's blogs" class="logo"> <span class="site-name can-hide">youngqluol's blogs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/JavaScript/" class="nav-link">
  基础及其他
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/Node/" class="nav-link router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/webpack/" class="nav-link">
  webpack
</a></li></ul></div></div><div class="nav-item"><a href="/frontend-blogs/pages/HTML/" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/frontend-blogs/pages/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/other/questions/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/other/interview/" class="nav-link">
  面试知识点
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/other/hr/" class="nav-link">
  HR面
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/JavaScript/" class="nav-link">
  基础及其他
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/Node/" class="nav-link router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/webpack/" class="nav-link">
  webpack
</a></li></ul></div></div><div class="nav-item"><a href="/frontend-blogs/pages/HTML/" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/frontend-blogs/pages/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/other/questions/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/other/interview/" class="nav-link">
  面试知识点
</a></li><li class="dropdown-item"><!----> <a href="/frontend-blogs/pages/other/hr/" class="nav-link">
  HR面
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>一、minimist （命令行参数解析）</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h4 id="一、minimist-命令行参数解析"><a href="#一、minimist-命令行参数解析" class="header-anchor">#</a> 一、minimist （命令行参数解析）</h4> <p><a href="https://github.com/substack/minimist" target="_blank" rel="noopener noreferrer">gitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>先了解下<code>process.argv</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 假设有以下脚本：</span>
process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 启动脚本：</span>
node process<span class="token operator">-</span>argv<span class="token punctuation">.</span>js one two<span class="token operator">=</span>three four

<span class="token comment">// 输出：</span>
<span class="token number">0</span><span class="token operator">:</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>node <span class="token comment">// process.execPath</span>
<span class="token number">1</span><span class="token operator">:</span> <span class="token operator">/</span>Users<span class="token operator">/</span>mjr<span class="token operator">/</span>work<span class="token operator">/</span>node<span class="token operator">/</span>process<span class="token operator">-</span>args<span class="token punctuation">.</span>js <span class="token comment">// 脚本文件的地址</span>
<span class="token number">2</span><span class="token operator">:</span> one
<span class="token number">3</span><span class="token operator">:</span> two<span class="token operator">=</span>three
<span class="token number">4</span><span class="token operator">:</span> four
</code></pre></div><p><code>process.argv</code>可以获取运行脚本时的命令行参数，而之所以常用<code>process.argv.slice(2)</code>，是因为一般第二个参数后才是我们需要的。
再来看<code>minimist</code>的用法及例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'minimist'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>举例：</p> <div class="language-js extra-class"><pre class="language-js"><code>node test<span class="token punctuation">.</span>js <span class="token operator">-</span>a a <span class="token operator">-</span>b b
<span class="token comment">// args: {_: [], a: 'a', b: 'b'}</span>

node test<span class="token punctuation">.</span>js <span class="token operator">-</span>x <span class="token number">3</span> <span class="token operator">-</span>y <span class="token number">4</span> <span class="token operator">-</span>n5 <span class="token operator">-</span>abc <span class="token operator">--</span>beep<span class="token operator">=</span>boop foo bar baz
<span class="token comment">// { _: [ 'foo', 'bar', 'baz' ],</span>
<span class="token comment">// x: 3,</span>
<span class="token comment">// y: 4,</span>
<span class="token comment">// n: 5,</span>
<span class="token comment">// a: true,</span>
<span class="token comment">// b: true,</span>
<span class="token comment">// c: true,</span>
<span class="token comment">// beep: 'boop' }</span>
</code></pre></div><p>解析参数，并放到一个对象中。特别要说明的是其中首个key是<code>_</code>，它的值是个数组，包含的是所有没有关联选项的参数。</p> <h4 id="二、chalk-终端多色彩输出"><a href="#二、chalk-终端多色彩输出" class="header-anchor">#</a> 二、chalk（终端多色彩输出）</h4> <p><a href="https://github.com/chalk/chalk" target="_blank" rel="noopener noreferrer">gitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>用于终端显示多色彩输出</p> <p>基本用法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chalk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 基础用法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'red2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 拼接</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'middle'</span> <span class="token operator">+</span> chalk<span class="token punctuation">.</span><span class="token function">blue</span><span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 多个样式</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span>blue<span class="token punctuation">.</span>bgRed<span class="token punctuation">.</span><span class="token function">bold</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 组合</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> chalk<span class="token punctuation">.</span>underline<span class="token punctuation">.</span><span class="token function">bgBlue</span><span class="token punctuation">(</span><span class="token string">'world'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="三、enquirer-终端交互"><a href="#三、enquirer-终端交互" class="header-anchor">#</a> 三、enquirer(终端交互)</h4> <p><a href="https://github.com/enquirer/enquirer" target="_blank" rel="noopener noreferrer">gitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>交互式询问用户输入</p> <p>基本用法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> prompt <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'enquirer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 单次询问：</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
    message<span class="token operator">:</span> <span class="token string">&quot;What's your name?&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2. 多次询问：</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token string">'What is your username?'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">'password'</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'password'</span><span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token string">'What is your password?'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">prompt</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>另一种调用方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 比如input类型：</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Input <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'enquirer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> prompt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Input</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  message<span class="token operator">:</span> <span class="token string">'What is your username?'</span><span class="token punctuation">,</span>
  initial<span class="token operator">:</span> <span class="token string">'jonschlinkert'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

prompt<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">answer</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Answer:'</span><span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>每次询问都需要指定一个类型<code>type</code>，或引入一个<code>Prompt类</code>。常见的有:</p> <ol><li><code>Input</code>:  普通输入，返回<code>String</code>类型</li> <li><code>Password</code>:  密码输入，返回<code>String</code>类型</li> <li><code>Confirm</code>： 确认，返回<code>Boolean</code>类型</li> <li><code>AutoComplete</code>: 自动补全</li> <li><code>BasicAuth</code>：基本认证（用户名、密码）</li> <li><code>Form</code>：表单</li> <li><code>Invisible</code>：不可见信息</li> <li><code>MultiSelect</code>: 选择多个</li> <li><code>Numeral</code>: 数字</li></ol> <h4 id="四、execa-执行命令"><a href="#四、execa-执行命令" class="header-anchor">#</a> 四、execa(执行命令)</h4> <p><a href="https://github.com/sindresorhus/execa" target="_blank" rel="noopener noreferrer">gitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>相当于我们在终端输入命令并执行</p> <p>先看原生写法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> util <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'util'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exec <span class="token operator">=</span> util<span class="token punctuation">.</span><span class="token function">promisify</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exec<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. 可以传入cwd参数指定执行的目录</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>cwd<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../../test'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 2. 另一种指定执行目录的方法是 process.chdir()</span>
process<span class="token punctuation">.</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string">'../../test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>跟原生的<code>exec</code>的主要区别或优势：</p> <ol><li>Promise支持</li> <li>更高的最大缓冲区。100mb而不是200kb。</li> <li>按名称执行本地安装的二进制文件。</li> <li>在父进程终止时清除派生的进程。</li> <li>更具描述性的错误。</li></ol> <p>基本api及用法：</p> <ol><li>execa(file, arguments?, options?)</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> stdout <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">execa</span><span class="token punctuation">(</span><span class="token string">'git'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 指定执行目录同样是传入cwd或者process.chdir()；</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> stdout <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">execa</span><span class="token punctuation">(</span><span class="token string">'git'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>cwd<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'../demo'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>execa.sync(file, arguments?, options?)：同步执行文件</li> <li>execa.command(command, options?): 与<code>execa()</code>相同，只是文件和参数都在单个命令字符串中指定</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>execa<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'git status'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>execa.commandSync(command, options?)：与 <code>execa.command()</code>相同，但是是同步的。</li></ol> <h4 id="五、fs-extra-操作文件"><a href="#五、fs-extra-操作文件" class="header-anchor">#</a> 五、fs-extra(操作文件)</h4> <p><a href="https://github.com/jprichardson/node-fs-extra" target="_blank" rel="noopener noreferrer">gitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>fs-extra</code>是原生<code>fs</code>的降级，<code>fs</code>中的所有方法都附加到了<code>fs-extra</code>中，并向<code>fs</code>添加了promise支持。如果没有传入回调，所有的fs方法都会返回promise 。</p> <p>先回顾下原生<code>fs</code>的一些常用方法：</p> <ol><li>获取文件类型：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token parameter">p</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> stat <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'../../README.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stat<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否是文件夹</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stat<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否是文件</span>
</code></pre></div><ol start="2"><li>文件或目录是否存在：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'../fs/fs.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>获取目录下的所有文件名</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../fs'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>读写(复制文件)</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> source <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./fs.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回的是一个Buffer对象</span>
fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./test.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>流读写</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> readStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./1.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
readStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 监听error</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'流读取失败：'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 
<span class="token keyword">const</span> writeStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'./2.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
writeStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'流写入失败：'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
writeStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'流写入完成'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
readStream<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writeStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="6"><li>重命名</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">renameSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./old.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./new.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="7"><li>创建文件/目录</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./newDir'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 写入文件（会覆盖之前的内容），文件不存在就创建</span>
fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./new.js'</span><span class="token punctuation">,</span> <span class="token string">'console.log(1)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="8"><li>删除文件/目录</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./newDir/test.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除文件</span>
<span class="token comment">// 只能删空目录，要删除非空文件夹，需要先把文件夹里的文件删除，再删除空文件夹</span>
fs<span class="token punctuation">.</span><span class="token function">rmdirSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./newDir'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="9"><li>追加文件内容</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">console.log(111)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">appendFileSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./new.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>再来看下<code>fs-extra</code>的一些常用API：</p> <ol><li>copy(src, dest[, options][, callback])：复制文件/文件夹</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs-extra'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// With a callback:</span>
fs<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token string">'/tmp/myfile'</span><span class="token punctuation">,</span> <span class="token string">'/tmp/mynewfile'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success!'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> 

<span class="token comment">// copies file</span>
fs<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token string">'/tmp/mydir'</span><span class="token punctuation">,</span> <span class="token string">'/tmp/mynewdir'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success!'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// copies directory, even if it has subdirectories or files</span>

<span class="token comment">// With Promises:</span>
fs<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token string">'/tmp/myfile'</span><span class="token punctuation">,</span> <span class="token string">'/tmp/mynewfile'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success!'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// With async/await:</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">example</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token string">'/tmp/myfile'</span><span class="token punctuation">,</span> <span class="token string">'/tmp/mynewfile'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>emptyDir(dir[, callback])：清空目录</li></ol> <p>确保目录是空的。如果目录非空，删除目录下所有内容。如果目录不存在，创建一个空目录。</p> <ol start="3"><li>ensureFile(file[, callback])： 创建文件</li></ol> <p>确保文件存在。如果被添加的文件所在的目录不存在,创建该目录。如果文件已经存在了,不进行操作。</p> <ol start="4"><li>ensureDir(dir[,options][,callback])： 创建目录</li></ol> <p>确保目录存在。如果不存在，则创建。</p> <ol start="5"><li>remove(path[, callback])：删除文件/目录</li></ol> <p>可以删除有内容的目录（这一点比<code>fs</code>优秀）。如果文件/目录存在，不进行任何操作。</p> <p>本次只介绍几个常用的库的一些基本用法。这些工具库的用法还有很多，如果想更完整的了解，可以点击相应库的gitHub地址查看。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/19/2021, 9:43:45 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/frontend-blogs/assets/js/app.6cbc603a.js" defer></script><script src="/frontend-blogs/assets/js/2.9c8862ee.js" defer></script><script src="/frontend-blogs/assets/js/25.aad0ee25.js" defer></script>
  </body>
</html>
